<html>
<head>
<title>Administracion de Sistemas</title>
<SCRIPT LANGUAGE="JavaScript" src="../scripts/archivo_documentos.js"></SCRIPT>
<!-- SCRIPT LANGUAGE="JavaScript" src="../scripts/archivo_documentos_cal.js"></SCRIPT  -->
{literal}
<SCRIPT LANGUAGE="JavaScript">
function openwin(phpwin){
	var opciones="left=350, top=50, width=550, height=500, toolbar=0, location=0, directories=0, status=0, menubar=0, scrollbars=1, resizable=1";
	window.open(phpwin,'maestro',opciones);
}

function seleccionar_todo(Cual){ 
	var cadena = "";
   for (i=0;i<document.documentos.elements.length;i++) 
      if(document.documentos.elements[i].type == "checkbox")	{
		cadena =  document.documentos.elements[i].name ;
		if( cadena.substr(0, 4)== Cual) 
			if(document.documentos.elements[i].checked==1) 
				document.documentos.elements[i].checked=0
			else
				document.documentos.elements[i].checked=1
	} 
}

</SCRIPT>
{/literal}
<link href="../styles/php.css" rel="stylesheet" type="text/css">
</head>

<body style="SCROLLBAR-FACE-COLOR: {$color_de_scroll};" bottomMargin=0 leftMargin=0 topMargin=0 rightMargin=0 
marginheight="0" marginwidth="0" class="color_contenido">
<DIV ID='overDiv' STYLE='position:absolute; visibility:hide; z-index:1;'></DIV>
<SCRIPT LANGUAGE='JavaScript' SRC='../overlib/overlib.js'></SCRIPT>
<div align="center">
	<table width="620" cellpadding="0" cellspacing="0" border="0" align="center">
		<tr>
		<td width="420" valign="middle" height="35">
			<div align="left"> <font class="tabla_titulo_contenido"> <strong>Propietario :</strong> {$titulo_nombre}</font> </div>
		</td>
		<td width="200" valign="middle" height="35">
			<div align="right"> <font class="tabla_titulo_contenido"> <a href="../code/_main.php?action=carpetas.php&carpeta_entrar=carpetas{if $editar=='chk'}{assign var='editar' value='ver'}&solover=vrb{/if}" class="link_tabla"> 
          Volver a lista de Carpetas</a></font> </div>
		</td>
		</tr>
		
		<tr>
		<td width="620" colspan="2" valign="middle" height="35">
			<div align="left"> <font class="tabla_titulo_contenido"> <strong>Carpeta :</strong> {$titulo_carpeta} </font> </div>
		</td>
		</tr>
	</table>
{if $editar=='ver'} {* aca solo mostramos no pueden editar, para ello ver mas abajo en el else *}

<table width="700" cellpadding="0" cellspacing="0" border="1" align="center" class="borde_lista">
	<tr class="tabla_titulo_color">
		
      <td colspan="6" height="30" valign="middle" class="borde_lista"> 
        &nbsp;Lista de Documentos <br><br>
		 <img src="../imagenes/pass/bien.gif" border="0">=Documento NO requerido&nbsp;&nbsp;
	  </td>

	</tr>
	{assign var="lugar_grupo" value="`xxx`"}
	{section name=lista loop=$los_documentos}
	<!--- para el encabezado de grupo ----->
	{if $los_documentos[lista.index].grupo <> $lugar_grupo}		
		<tr class="tabla_titulo_contenido">
		  <td width="700" colspan="6" valign="middle" align="left" height="25" class="borde_lista"> 
		  	<font class="contenido_tabla_login">
			&nbsp;Grupo: {if $los_documentos[lista.index].grupo==1}Mandatorios{else}Documentaci&oacute;n Complementaria{/if}
			{assign var="lugar_grupo" value=$los_documentos[lista.index].grupo}
			</font>
			</td>
		</tr>
		<tr class="tabla_titulo_color">
		  <td width="20" align="left" class="borde_lista" nowrap> 
			&nbsp;<img src="../imagenes/pass/bien.gif" border="0"></td>
			<td width="340" align="left" class="borde_lista" nowrap> 
		  	&nbsp;Documento</td>
			<td width="80" align="left" class="borde_lista" nowrap> 
			&nbsp;N&uacute;mero</td>
			<td width="80" align="left" class="borde_lista" nowrap> 
			&nbsp;Fecha</td>
			<td width="80" align="left" class="borde_lista" nowrap>
			&nbsp;Vence</td>
			<td width="100" align="left" class="borde_lista" nowrap> 
		  	&nbsp;Docs.</td>

		</tr>
	{/if}
	<tr class="tabla_titulo_contenido">
		  <td width="20" align="left" class="borde_parecido" nowrap>
			{if $los_documentos[lista.index].falta == 1 && $cant_documentos > 0}<img src="../imagenes/pass/bien.gif" border="0">{/if}</td>
			<td width="340" align="left" class="borde_parecido" nowrap>
		  	&nbsp;<strong>{$los_documentos[lista.index].documento}</strong>{if $los_documentos[lista.index].observacion !=''}<br />
			&nbsp;Nota:&nbsp;{$los_documentos[lista.index].observacion}{/if}
			</td>
			<td width="80" align="left" class="borde_parecido" nowrap>
			{$los_documentos[lista.index].numero}</td>
			<td width="80" align="left" class="borde_parecido">{$los_documentos[lista.index].fecha}</td>
			<td width="80" align="left" class="borde_parecido">{$los_documentos[lista.index].vence}</td>
			<td width="100" align="left" class="borde_parecido" nowrap> 
			{$los_documentos[lista.index].fojas}&nbsp;
				{section name=sublista loop=$tipos_doc}
				{if $tipos_doc[sublista.index].id_tipo == $los_documentos[lista.index].id_tipo} {$tipos_doc[sublista.index].tipo}{/if}
				{/section}
			</td>
	</tr>
	{/section}
</table>

{else}
<form name="documentos" method="post" action="../code/_main.php?action=carpetas.php" enctype="multipart/form-data">

<table width="700" cellpadding="0" cellspacing="0" border="1" align="center" class="borde_lista">
	<tr class="tabla_titulo_color">
		
      <td colspan="3" height="30" valign="middle" class="borde_lista"> 
        &nbsp;Lista de Documentos {if $editar=='ver'}(SOLO LECTURA){else}&nbsp;&nbsp;&nbsp;&nbsp;<font class="tabla_titulo_contenido"><a href="javascript: void(0);" onClick="marcatodo();">Marcar todos como no requeridos</a></font>{/if}<br><br>
		 <img src="../imagenes/pass/bien.gif" border="0">=Documento NO requerido&nbsp;&nbsp;
	  </td>
	  <td colspan="3" height="30" valign="middle" class="borde_lista" align="right"> 
        &nbsp;<br><br>
		 <img src="../imagenes/pass/bien2.gif" border="0">=Excluir del reporte de obs.&nbsp;
	  </td>
	</tr>
	{if $editar=='ver'}{assign var="ReadOnly" value="readonly"}{else}{assign var="ReadOnly" value=""}{/if}
	
	{assign var="lugar_grupo" value="`xxx`"}
	{section name=lista loop=$los_documentos}
	<!--- para el encabezado de grupo ----->
	{if $los_documentos[lista.index].grupo <> $lugar_grupo}	
		<tr class="tabla_titulo_contenido">
		  <td width="700" colspan="6" valign="middle" align="left" height="25" class="borde_lista"> 
		  	<font class="contenido_tabla_login">
			&nbsp;Grupo: {if $los_documentos[lista.index].grupo==1}Mandatorios{else}Documentaci&oacute;n Complementaria{/if}
			{assign var="lugar_grupo" value=$los_documentos[lista.index].grupo}
			</font>
			</td>
		</tr>
		<tr class="tabla_titulo_color">
		  <td width="20" align="left" class="borde_lista" nowrap> 
			&nbsp;<a href="javascript:seleccionar_todo('tien')" title="Documento no requerido"><img src="../imagenes/pass/bien.gif" border="0"></a></td>
			<td width="250" align="left" class="borde_lista" nowrap> 
		  	&nbsp;Documento</td>
			<td width="310" align="left" class="borde_lista" nowrap>
			<table border="0" cellpadding="0" cellspacing="0" width="100%" class="borde_lista">
			<tr class="tabla_titulo_color"><td width="34%">&nbsp;Nro. Doc.</td><td width="33%">&nbsp;Fecha Doc. (dd/mm/aaaa)</td><td width="33%">&nbsp;Fecha Vencimiento</td></tr>
			</table></td>
			<td width="60" align="left" class="borde_lista" nowrap> 
		  	&nbsp;Tipo_Doc.</td>
			<td width="40" align="left" class="borde_lista" nowrap> 
			&nbsp;Fojas</td>
			<td width="20" align="left" class="borde_lista" nowrap> 
			&nbsp;<a href="javascript:seleccionar_todo('noob')" title="Excluir del reporte de obs."><img src="../imagenes/pass/bien2.gif" border="0"></a></td>
		</tr>
	{/if}
	<tr class="tabla_titulo_contenido">
		  <td width="20" align="left" class="borde_parecido" nowrap>
		{if $editar!='ver'}
			<input type="checkbox" class="input" name="tiene_{$smarty.section.lista.index}" {if $los_documentos[lista.index].falta == 1 && $cant_documentos > 0}checked{/if} {$ReadOnly}>
		{else}
			{if $los_documentos[lista.index].archivo != ''}
			<a href="../code/_main.php?action=carpetas.php&descargar={$los_documentos[lista.index].archivo}&idc={$id_carpeta}" title="Descargar Documento" target="_blank"><img src="../images/actions/clip.jpeg" border="0"></a>
			{/if}
		{/if}
			</td>
			<td width="250" align="left" class="borde_parecido" nowrap>
		  	&nbsp;{$los_documentos[lista.index].documento}&nbsp;
			{if $los_documentos[lista.index].seguro == 1}
			<a href="#" onclick="openwin('seguro.php?id_dp={$los_documentos[lista.index].id_doc_pro}');">(datos adicionales)<a>
			{/if}
			<input type="hidden" name="requerido[]" value="{$los_documentos[lista.index].requerido}">
			<input type="hidden" name="id_documento[]" value="{$los_documentos[lista.index].id_documento}">
			<input type="hidden" name="id_doc_pro[]" value="{$los_documentos[lista.index].id_doc_pro}">
			</td>
			<td width="310" align="left" class="borde_parecido" nowrap>
			<table border="0" cellpadding="0" cellspacing="0" width="100%" >
			<tr class="tabla_titulo_contenido"><td width="34%">{if $los_documentos[lista.index].con_numero == 1}
			<input type="text" name="numero[]" class="input_derecha" size="10" value="{$los_documentos[lista.index].numero}" {$ReadOnly}>
			{else}
			<input type="hidden" name="numero[]" value="0">
			{/if}</td>
			<td width="33%">{if $los_documentos[lista.index].tiene_fecha == 1}
				{if $los_documentos[lista.index].vencimiento == 1}
					<input type="text" name="fecha_{$smarty.section.lista.index}" class="input_derecha" size="12" 
					value="{$los_documentos[lista.index].fecha}" 
					onKeyUp="colocar_fecha_vencimiento( fecha_{$smarty.section.lista.index}, 
								vencim_{$smarty.section.lista.index}, 
								fecha_venc{$smarty.section.lista.index}, 
								{$smarty.section.lista.index})" {$ReadOnly}>
					<input type="hidden" name="vencim_{$smarty.section.lista.index}" value="{$los_documentos[lista.index].meses_vencimiento}">
				{else}
					<input type="text" name="fecha_{$smarty.section.lista.index}" class="input_derecha" size="12" value="{$los_documentos[lista.index].fecha}" onKeyUp="colocar_fecha(fecha_{$smarty.section.lista.index})" {$ReadOnly}>
				{/if}
			{else}
				&nbsp;
			{/if}</td>
			<td width="33%">{if $los_documentos[lista.index].vencimiento == 1}
				<input type="text" name="fecha_venc{$smarty.section.lista.index}" class="input_derecha" size="12" value="{$los_documentos[lista.index].vence}" onKeyUp="colocar_fecha(fecha_venc{$smarty.section.lista.index})" {$ReadOnly}>
			{else}
				&nbsp;
			{/if}</td>
			</tr>
			</table>
			</td>
			<td width="60" align="left" class="borde_parecido" nowrap> 
		  	
			{if $editar=='ver'}
				{section name=sublista loop=$tipos_doc}
				{if $tipos_doc[sublista.index].id_tipo == $los_documentos[lista.index].id_tipo}<input type="text" class="input" name="xxx" value="{$tipos_doc[sublista.index].tipo}" size="14" {$ReadOnly}>{/if}
				{/section}
			{else}<select name="tipo[]" class="input" >
				<option value="0" selected>--------</option>
				{section name=sublista loop=$tipos_doc}
				<option value="{$tipos_doc[sublista.index].id_tipo}" {if $tipos_doc[sublista.index].id_tipo == $los_documentos[lista.index].id_tipo}selected{/if}>{$tipos_doc[sublista.index].tipo}</option>
				{/section}</select>
			{/if}
			</td>
			<td width="40" align="left" class="borde_parecido" nowrap> 
			<input type="text" class="input_derecha" name="fojas[]" value="{$los_documentos[lista.index].fojas}" size="6" maxlength="3" onkeypress="javascript:return ValidNumEntero(event);" {$ReadOnly}></td>
			
			<td width="20" align="left" class="borde_parecido" nowrap>
			<input type="checkbox" class="input" name="noobs_{$smarty.section.lista.index}" {if $los_documentos[lista.index].noobs == 1}checked{/if} {$ReadOnly}></td>
	</tr>
	<tr class="tabla_titulo_contenido">
		  <td width="20" align="left" class="borde_parecido" nowrap>&nbsp;</td>
			<td width="250" align="right" class="borde_parecido" nowrap>Nota:&nbsp;</td>
			<td width="430" align="left" class="borde_parecido" nowrap colspan="4"> 
			<textarea class="input" name="obs[]" id="obs_{$smarty.section.lista.index}" rows="2" cols="80" {$ReadOnly}>{$los_documentos[lista.index].observacion}</textarea><br />
			{if $los_documentos[lista.index].archivo != ''}
			<a href="../code/_main.php?action=carpetas.php&descargar={$los_documentos[lista.index].id_doc_pro}" title="Descargar Documento" target="_blank"><img src="../images/actions/clip.jpeg" border="0"> Descargar Documento</a>&nbsp;&nbsp;
			{if $edoc=='S'}
			<a href="../code/_main.php?action=carpetas.php&eliadjunto={$los_documentos[lista.index].id_doc_pro}&documentos=ok&id_cpd={$id_carpeta}&id_tcarp={$id_tc}" 
			title="Eliminar Documento" onclick="return confirmadel();"><img src="../images/actions/cross.png" border="0"> Eliminar Documento</a>
			{/if}
			{else} 
			<input type="hidden" name="id_file[]" value="{$los_documentos[lista.index].id_documento}">
			Adjuntar: <input type="file" class="boton" id="miarchivo_{$smarty.section.lista.index}" name="miarchivo[]" _multiple="" accept="{$extension}"></td>
			{/if}
	</tr>
	{/section}
</table>
<br><br>
{if $editar=='ok'}
<table width="620" cellpadding="0" cellspacing="0" border="0">
	<tr>
	<td width="620"><div align="center">
		<input type="submit" name="adicionarx" value=" Guardar " class="boton">
		<input type="hidden" name="carpeta_entrar" value="guardando">
		<input type="hidden" name="guardar_documentos" value="si">
		<input type="hidden" name="id_carpeta" value="{$id_carpeta}">
		<input type="hidden" name="cantidad_total" value="{$cantidad_total}">
	</div></td>
	</tr>
</table>
{/if}
</form>
{/if}
<br><br>
</div>

{literal}
<script>
function confirmadel(){
	xval = confirm("Seguro de eliminar este archivo adjunto?");
	return xval;
}
</script>
{/literal}
</body>
</html>
